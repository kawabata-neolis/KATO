MERGE INTO [KATO].[dbo].倉庫間移動 AS A
USING
    (
        SELECT
            @0 AS 伝票年月日
           ,@1 AS 伝票番号
           ,@2 AS 処理番号
           ,@3 AS 倉庫コード
           ,@4 AS 取引区分
           ,@5 AS 担当者コード
           ,@6 AS 営業所コード
           ,@7 AS 商品コード
           ,@8 AS メーカーコード
           ,@9 AS 大分類コード
           ,@10 AS 中分類コード
           ,@11 AS Ｃ１
           ,@12 AS Ｃ２
           ,@13 AS Ｃ３
           ,@14 AS Ｃ４
           ,@15 AS Ｃ５
           ,@16 AS Ｃ６
           ,@17 AS 数量
           ,@18 AS 単価
           ,@19 AS 移動元倉庫
           ,@20 AS 登録日時
           ,@21 AS 登録ユーザー名
           ,@22 AS 更新日時
           ,@23 AS 更新ユーザー名
    ) AS B
ON
    (
        A.伝票番号 = B.伝票番号
    AND A.処理番号 = B.処理番号
    AND A.取引区分 = B.取引区分
   )
WHEN MATCHED THEN
    UPDATE
    SET
        伝票年月日 = B.伝票年月日
       ,倉庫コード = B.倉庫コード
       ,担当者コード = B.担当者コード
       ,営業所コード = B.営業所コード
       ,商品コード = B.商品コード
       ,メーカーコード = B.メーカーコード
       ,大分類コード = B.大分類コード
       ,中分類コード = B.中分類コード
       ,Ｃ１ = B.Ｃ１
       ,Ｃ２ = B.Ｃ２
       ,Ｃ３ = B.Ｃ３
       ,Ｃ４ = B.Ｃ４
       ,Ｃ５ = B.Ｃ５
       ,Ｃ６ = B.Ｃ６
       ,数量 = B.数量
       ,単価 = B.単価
       ,移動元倉庫 = B.移動元倉庫
       ,更新日時 = B.更新日時
       ,更新ユーザー名 = B.更新ユーザー名
WHEN NOT MATCHED THEN
    INSERT(
        伝票年月日
       ,伝票番号
       ,処理番号
       ,倉庫コード
       ,取引区分
       ,担当者コード
       ,営業所コード
       ,商品コード
       ,メーカーコード
       ,大分類コード
       ,中分類コード
       ,Ｃ１
       ,Ｃ２
       ,Ｃ３
       ,Ｃ４
       ,Ｃ５
       ,Ｃ６
       ,数量
       ,単価
       ,移動元倉庫
       ,登録日時
       ,登録ユーザー名
       ,更新日時
       ,更新ユーザー名
    )
    VALUES
    (
	    B.伝票年月日
       ,B.伝票番号
       ,B.処理番号
       ,B.倉庫コード
       ,B.取引区分
       ,B.担当者コード
       ,B.営業所コード
       ,B.商品コード
       ,B.メーカーコード
       ,B.大分類コード
       ,B.中分類コード
       ,B.Ｃ１
       ,B.Ｃ２
       ,B.Ｃ３
       ,B.Ｃ４
       ,B.Ｃ５
       ,B.Ｃ６
       ,B.数量
       ,B.単価
       ,B.移動元倉庫
       ,B.登録日時
       ,B.登録ユーザー名
       ,B.更新日時
       ,B.更新ユーザー名
    )
;