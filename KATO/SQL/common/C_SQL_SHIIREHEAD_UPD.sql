MERGE INTO [KATO].[dbo].仕入ヘッダ AS A
USING
    (
        SELECT
            @0 AS 伝票番号
           ,@1 AS 伝票年月日
           ,@2 AS 仕入先コード
           ,@3 AS 仕入先名
           ,@4 AS 郵便番号
           ,@5 AS 住所１
           ,@6 AS 住所２
           ,@7 AS 取引区分
           ,@8 AS 担当者コード
           ,@9 AS 営業所コード
           ,@10 AS 摘要コード
           ,@11 AS 摘要欄
           ,@12 AS 運賃
           ,@13 AS 税抜合計金額
           ,@14 AS 消費税
           ,@15 AS 税込合計金額
           ,@16 AS 請求書発行フラグ
           ,@17 AS 伝票発行フラグ
           ,@18 AS 直送先コード
           ,@19 AS 直送先名
           ,@20 AS 直送先郵便番号
           ,@21 AS 直送先住所１
           ,@22 AS 直送先住所２
           ,@23 AS 削除
           ,@24 AS 登録日時
           ,@25 AS 登録ユーザー名
           ,@26 AS 更新日時
           ,@27 AS 更新ユーザー名
    ) AS B
ON
    (
        A.伝票番号 = B.伝票番号
    )
WHEN MATCHED THEN
    UPDATE
    SET
        伝票年月日 = B.伝票年月日
       ,仕入先コード = B.仕入先コード
       ,仕入先名 = B.仕入先名
       ,郵便番号 = B.郵便番号
       ,住所１ = B.住所１
       ,住所２ = B.住所２
       ,取引区分 = B.取引区分
       ,担当者コード = B.担当者コード
       ,営業所コード = B.営業所コード
       ,摘要コード = B.摘要コード
       ,摘要欄 = B.摘要欄
       ,運賃 = B.運賃
       ,税抜合計金額 = B.税抜合計金額
       ,消費税 = B.消費税
       ,税込合計金額 = B.税込合計金額
       ,請求書発行フラグ = B.請求書発行フラグ
       ,伝票発行フラグ = B.伝票発行フラグ
       ,直送先コード = B.直送先コード
       ,直送先名 = B.直送先名
       ,直送先郵便番号 = B.直送先郵便番号
       ,直送先住所１ = B.直送先住所１
       ,直送先住所２ = B.直送先住所２
       ,削除 = B.削除
       ,更新日時 = B.更新日時
       ,更新ユーザー名 = B.更新ユーザー名
WHEN NOT MATCHED THEN
    INSERT(
        伝票番号
       ,伝票年月日
       ,仕入先コード
       ,仕入先名
       ,郵便番号
       ,住所１
       ,住所２
       ,取引区分
       ,担当者コード
       ,営業所コード
       ,摘要コード
       ,摘要欄
       ,運賃
       ,税抜合計金額
       ,消費税
       ,税込合計金額
       ,請求書発行フラグ
       ,伝票発行フラグ
       ,直送先コード
       ,直送先名
       ,直送先郵便番号
       ,直送先住所１
       ,直送先住所２
       ,削除
       ,登録日時
       ,登録ユーザー名
       ,更新日時
       ,更新ユーザー名
    )
    VALUES
    (
	    B.伝票番号
       ,B.伝票年月日
       ,B.仕入先コード
       ,B.仕入先名
       ,B.郵便番号
       ,B.住所１
       ,B.住所２
       ,B.取引区分
       ,B.担当者コード
       ,B.営業所コード
       ,B.摘要コード
       ,B.摘要欄
       ,B.運賃
       ,B.税抜合計金額
       ,B.消費税
       ,B.税込合計金額
       ,B.請求書発行フラグ
       ,B.伝票発行フラグ
       ,B.直送先コード
       ,B.直送先名
       ,B.直送先郵便番号
       ,B.直送先住所１
       ,B.直送先住所２
       ,B.削除
       ,B.登録日時
       ,B.登録ユーザー名
       ,B.更新日時
       ,B.更新ユーザー名
    )
;